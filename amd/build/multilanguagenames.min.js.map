{"version":3,"file":"multilanguagenames.min.js","sources":["../src/multilanguagenames.js"],"sourcesContent":["// This file is part of Moodle - http://moodle.org/\n//\n// Moodle is free software: you can redistribute it and/or modify\n// it under the terms of the GNU General Public License as published by\n// the Free Software Foundation, either version 3 of the License, or\n// (at your option) any later version.\n//\n// Moodle is distributed in the hope that it will be useful,\n// but WITHOUT ANY WARRANTY; without even the implied warranty of\n// MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the\n// GNU General Public License for more details.\n//\n// You should have received a copy of the GNU General Public License\n// along with Moodle.  If not, see <http://www.gnu.org/licenses/>.\n\n/* eslint-disable no-console */\n\n/**\n * TODO describe module Multi-language section and activity names\n *\n * @module     local_multilanguagenames/multilanguagenames\n * @copyright  2025 Andrew Rowatt <A.J.Rowatt@massey.ac.nz>\n * @license    http://www.gnu.org/copyleft/gpl.html GNU GPL v3 or later\n */\n\nimport $ from 'jquery';\nimport Util from 'local_multilanguagenames/Util';\nimport {exception as displayException} from 'core/notification';\nimport Templates from 'core/templates';\n\nexport const init = () => {\n    $(function() {\n        console.log(\"Multi-language section and activity names (local_multilanguagenames) module initialized\");\n        // Add your module initialization code here\n        const idName = $('#id_name').val();\n\n        var util = new Util(idName);\n        if (util.multilanguageName) {\n            $('#fitem_id_name').addClass('hidden');\n        }\n\n        let context = {\n            name: idName,\n            multilanguageName: util.multilanguageName,\n            multilanguagenamePlaintext: util.generatePlaintext(),\n            name1: util.name1,\n            name2: util.name2,\n            name3: util.name3,\n            preview: util.generateHTML(),\n        };\n\n        context[`name1lang${util.name1lang}`] = true;\n        context[`name2lang${util.name2lang}`] = true;\n        context[`name3lang${util.name3lang}`] = true;\n\n        // This will call the function to load and render our template.\n        Templates.renderForPromise('local_multilanguagenames/edit_form', context)\n        // eslint-disable-next-line promise/always-return\n        .then(({html}) => {\n            $(html).insertAfter('#fitem_id_name');\n\n            // Setup event handlers for the multi-language name field changes\n            $('#usemultilanguagename').on('change', function() {\n                if ($(this).is(':checked')) {\n                    $('#id_name_customize:not(:checked)').trigger(\"click\").addClass('hidden');\n                    $('#fitem_id_name').addClass('hidden');\n\n                    $('#fitem_id_name_shadow').removeClass('hidden');\n                    $('#namemultilang_group').removeClass('hidden');\n\n                    if (!util.multilanguageName) {\n                        // Parse the name into the three name fields\n                        util.convertToMultilanguageName();\n                    }\n\n                    $('#name1').val(util.name1).prop('required', true);\n                    // Note we set required to avoid issues if the multilanguage feature is not enabled for this section.\n\n                    $('#name2').val(util.name2);\n                    $('#name3').val(util.name3);\n\n                    $('#id_name_shadow').val(util.generatePlaintext());\n                    html = util.generateHTML();\n                    $('#id_name').val(util.generateHTML());\n                    $('#namemultilang_preview').html(html);\n                } else {\n                    $('#id_name').val($('#id_name_shadow').val());\n                    $('#fitem_id_name').removeClass('hidden');\n                    $('#fitem_id_name_shadow').addClass('hidden');\n                    $('#namemultilang_group').addClass('hidden');\n\n                    // Note we set required to avoid issues if the multilanguage feature is not enabled for this section.\n                    $('#name1').prop('required', false);\n                }\n            });\n\n            $('#namemultilang_group input[type=\"text\"]').on('input', function() {\n                const name1 = $('#name1').val();\n                const name2 = $('#name2').val();\n                const name3 = $('#name3').val();\n\n                util.name1 = name1;\n                util.name2 = name2;\n                util.name3 = name3;\n\n                $('#id_name_shadow').val(util.generatePlaintext());\n                html = util.generateHTML();\n                $('#id_name').val(util.generateHTML());\n                $('#namemultilang_preview').html(html);\n            });\n\n            $('#namemultilang_group select').on('change', function() {\n                const name1lang = $('#name1lang').val();\n                const name2lang = $('#name2lang').val();\n                const name3lang = $('#name3lang').val();\n\n                util.name1lang = name1lang;\n                util.name2lang = name2lang;\n                util.name3lang = name3lang;\n\n                // Do not need to update the plaintext version of the name, just the HTML version\n                html = util.generateHTML();\n                $('#id_name').val(util.generateHTML());\n                $('#namemultilang_preview').html(html);\n            });\n        })\n        .catch((error) => displayException(error));\n    });\n};\n"],"names":["console","log","idName","val","util","Util","multilanguageName","addClass","context","name","multilanguagenamePlaintext","generatePlaintext","name1","name2","name3","preview","generateHTML","name1lang","name2lang","name3lang","renderForPromise","then","_ref","html","insertAfter","on","this","is","trigger","removeClass","convertToMultilanguageName","prop","catch","error"],"mappings":";;;;;;;0NA8BoB,0BACd,WACEA,QAAQC,IAAI,iGAENC,QAAS,mBAAE,YAAYC,UAEzBC,KAAO,IAAIC,cAAKH,QAChBE,KAAKE,uCACH,kBAAkBC,SAAS,cAG7BC,QAAU,CACVC,KAAMP,OACNI,kBAAmBF,KAAKE,kBACxBI,2BAA4BN,KAAKO,oBACjCC,MAAOR,KAAKQ,MACZC,MAAOT,KAAKS,MACZC,MAAOV,KAAKU,MACZC,QAASX,KAAKY,gBAGlBR,2BAAoBJ,KAAKa,aAAe,EACxCT,2BAAoBJ,KAAKc,aAAe,EACxCV,2BAAoBJ,KAAKe,aAAe,qBAG9BC,iBAAiB,qCAAsCZ,SAEhEa,MAAKC,WAACC,KAACA,+BACFA,MAAMC,YAAY,sCAGlB,yBAAyBC,GAAG,UAAU,YAChC,mBAAEC,MAAMC,GAAG,iCACT,oCAAoCC,QAAQ,SAASrB,SAAS,8BAC9D,kBAAkBA,SAAS,8BAE3B,yBAAyBsB,YAAY,8BACrC,wBAAwBA,YAAY,UAEjCzB,KAAKE,mBAENF,KAAK0B,iDAGP,UAAU3B,IAAIC,KAAKQ,OAAOmB,KAAK,YAAY,uBAG3C,UAAU5B,IAAIC,KAAKS,2BACnB,UAAUV,IAAIC,KAAKU,2BAEnB,mBAAmBX,IAAIC,KAAKO,qBAC9BY,KAAOnB,KAAKY,mCACV,YAAYb,IAAIC,KAAKY,oCACrB,0BAA0BO,KAAKA,4BAE/B,YAAYpB,KAAI,mBAAE,mBAAmBA,2BACrC,kBAAkB0B,YAAY,8BAC9B,yBAAyBtB,SAAS,8BAClC,wBAAwBA,SAAS,8BAGjC,UAAUwB,KAAK,YAAY,2BAInC,2CAA2CN,GAAG,SAAS,iBAC/Cb,OAAQ,mBAAE,UAAUT,MACpBU,OAAQ,mBAAE,UAAUV,MACpBW,OAAQ,mBAAE,UAAUX,MAE1BC,KAAKQ,MAAQA,MACbR,KAAKS,MAAQA,MACbT,KAAKU,MAAQA,0BAEX,mBAAmBX,IAAIC,KAAKO,qBAC9BY,KAAOnB,KAAKY,mCACV,YAAYb,IAAIC,KAAKY,oCACrB,0BAA0BO,KAAKA,6BAGnC,+BAA+BE,GAAG,UAAU,iBACpCR,WAAY,mBAAE,cAAcd,MAC5Be,WAAY,mBAAE,cAAcf,MAC5BgB,WAAY,mBAAE,cAAchB,MAElCC,KAAKa,UAAYA,UACjBb,KAAKc,UAAYA,UACjBd,KAAKe,UAAYA,UAGjBI,KAAOnB,KAAKY,mCACV,YAAYb,IAAIC,KAAKY,oCACrB,0BAA0BO,KAAKA,YAGxCS,OAAOC,QAAU,2BAAiBA"}